“Human” Version
Core Rules for First-Species (Note-against-Note) Counterpoint
(summarised from Fux, Gradus ad Parnassum, Book I)
Here’s a correctly renumbered and structured version of your text so that each section and sub section follows a clear, consistent hierarchy:
 
1. Conventional Procedure for Identifying the Mode of a Cantus Firmus Alone
1.1 Find the Final
•	The final is the last note of the melody (and in nearly every Fuxian example, also the first).
•	It functions as the tonal centre; all modal relationships are measured from this pitch.
1.2 Compare the Pitch-Collection with the Six Usable Modes
Final	Mode (authentic form)	Ascending step-pattern from the final (W = whole-step, H = half-step)	Accidental(s) allowed inside the cantus
D	Dorian	W – H – W – W – W – H – W	C♯ may appear in the next-to-last bar
E	Phrygian	H – W – W – W – H – W – W	F♯ may appear in the next-to-last bar
F	Lydian	W – W – W – H – W – W – H	B♭ may appear anywhere to suppress the F–B tritone
G	Mixolydian	W – W – H – W – W – H – W	F♯ may appear in the next-to-last bar
A	Aeolian	W – H – W – W – H – W – W	G♯ may appear in the next-to-last bar
C	Ionian	W – W – H – W – W – W – H	No accidental required

The pitch B cannot serve as a final in Fux: its fifth (F) is diminished, so no perfect consonant frame is possible.
Method:
1.	List every pitch that occurs in the cantus.
2.	For each mode whose final matches the last note, test whether every pitch belongs to that mode’s diatonic set (taking into account the single “licensed” accidental shown above).
3.	Eliminate any mode that fails this test.

1.3 Decide Authentic vs Plagal by Ambitus
•	Authentic species: melody does not descend below its final and rises roughly to the octave above (typical ambitus: final to +8). ->possible exception to ad +1 or -1 of range.
•	Plagal species: melody reaches about a fourth below the final and a fifth above (typical ambitus: −4 to +5). -> possible exception to ad +1 or -1 of range.
•	If the melodic range does not match either profile, re-examine the modal hypothesis.
1.4 Confirm with Internal Cadences
•	In authentic modes, most points of repose or longer note-values settle on the final or its fifth.
•	In plagal modes, they tend to settle on the third above the final.
•	A contradictory cadence pattern usually means the wrong mode has been chosen.
1.5 Audit the Accidentals in the Cantus
An accidental is legitimate only if it
1.	occurs in the penultimate note to create the major-6th/minor-3rd clausula (leading-tone), or
2.	removes a melodic tritone (“mi contra fa”).
Any other accidental contradicts modal integrity and disqualifies the reading.
1.6 Final Determination
The correct mode is the one that simultaneously:
1.	accommodates all cantus pitches within its scale (plus the strictly permitted accidental),
2.	matches the observed authentic or plagal ambitus, and
3.	aligns with the internal cadence behaviour.
Establishing the mode before writing the added counterpoint ensures that the new voice will respect the tonal grammar prescribed by Fux’s method.
 
2. Vertical Intervals
2.1 Basic Rules
1.	Write one counterpoint note for each cantus-firmus note; all notes share the same time-value, normally whole notes, except if another value is requested.
2.	Use consonances only:
o	Perfect – unison, perfect 5th, perfect 8ve.
o	Imperfect – major/minor 3rd, major/minor 6th.
3.	Employ more imperfect than perfect consonances to maintain harmonic richness.
4.	Beginning and final bar must be perfect consonances (customarily unison or octave; a 5th is permitted only at the opening when the counterpoint lies above the cantus firmus).
5.	Penultimate bar cadence rule:
o	Cantus firmus below → counterpoint forms a major 6th above it.
o	Cantus firmus above → counterpoint forms a minor 3rd below it.
o	Raise the 7th scale-degree, where necessary, to create a leading tone.
 
3. Treatment of Motion Between the Two Voices
3.1 Preference for Motion
•	Contrary or oblique motion is preferred; it prevents parallelism and preserves independence.
3.2 Interval Categories
Scope:
These rules govern the vertical relationship (simultaneous interval) between the two voices and prescribe how each line must move from one note to the next in order to preserve contrapuntal independence.
Progression Rules:
•	Perfect → Perfect: only contrary or oblique motion; parallel or similar motion is forbidden.
•	Perfect → Imperfect: any of the three motions (contrary, parallel, oblique) is permitted.
•	Imperfect → Imperfect: any of the three motions is permitted.
•	Imperfect → Perfect: only contrary or oblique motion; parallel and similar motion is forbidden.
Purpose:
Following these pathways ensures that successive intervals remain consonant and that each voice maintains melodic autonomy, thereby preventing exposed or hidden parallel fifths and octaves.
3.3 Additional Prohibitions
1.	Parallel or “direct/hidden” 5ths & 8ves are prohibited. Two successive perfect consonances reached by similar motion, especially if the upper part leaps, are invalid.
2.	Avoid approaching an octave by contrary stepwise motion from a 10th (ottava battuta).
3.	Avoid any leap into or out of a unison except at the beginning or end.
4. Melodic Conduct Within Each Voice
4.1 Maintain Vocal Singability
•	No augmented, diminished or chromatic melodic intervals.
•	Leaps larger than a perfect 5th are disallowed except (i) an ascending minor 6th, and (ii) the octave.
4.2 Stepwise Compensation
•	Do not chain leaps in the same direction; compensate any leap with stepwise motion in the opposite direction.
4.3 Pitch Repetition
•	Avoid repeating a pitch more than once consecutively (the only form of oblique motion in first species).
4.4 Tritones
•	No melodic or vertical tritone (mi contra fa); an augmented 4th or diminished 5th is inadmissible in strict diatonic style.
4.5 Range
•	Keep both parts within a practicable vocal range and steer clear of registers that are excessively high or low.
5. Voice Disposition
5.1 Counting Intervals
•	When the counterpoint lies above the cantus firmus, intervals are counted upward; when below, count downward.
5.2 Voice-Crossing
•	Voice-crossing is permissible but should be employed sparingly and only to secure superior melodic or contrapuntal smoothness.
5.3 Spacing
•	Keep the voices neither so close that they obscure independence nor so far apart that compound intervals (≥ 11th) dominate the texture.
6. Working Procedure — Incremental, Rule-Checked Writing
6.1  Step-by-step construction
1.	Begin with a cantus-firmus note-grid: request where the second voice has to be written, above or under. 
2.	Proceed one cantus note at a time, adding exactly one counterpoint note to the other voice above or under.
6.2  Immediate compliance check for every new note
For the freshly written note:
Check-list (apply in this order)	Governing sections
1 . Vertical consonance type & balance	§ 2.1, § 2.1-3
2 . Motion category vs. previous sonority	§ 3.1-3
3 . Forbidden parallels / hidden perfects	§ 3.3
4 . Melodic fitness of the single line	§ 4.1-4.5
5 . Spacing / voice-crossing constraints	§ 5.1-5.3
6 . Modal integrity (accidental legality)	§ 1.5
6.3  Error-handling logic
•	If one or more checks fail:
1.	Erase the problematic note.
2.	Try an alternative pitch that still fulfils the basic interval requirement (perfect vs imperfect).
3.	
•	If all feasible alternatives fail:
1.	Step back one (or more) notes in the counterpoint.
2.	Replace the earlier note(s) with different legal options, then resume forward writing.
Think of the process as depth-first search with backtracking: no note is final until it survives the entire check-list.
By incorporating this iterative “write-and-verify” routine, section 6 now prescribes a concrete workflow: every note is validated in real time, alternatives are explored whenever a rule is breached, and systematic backtracking guarantees that the finished counterpoint satisfies every requirement laid out in §§ 1-5. 
“LLM translated” Version
 
0. Core Data Types
Pitch     = str                 # e.g. "C4", "F#3"
Mode      = Enum("Dorian", "Phrygian", "Lydian", "Mixolydian", "Aeolian", "Ionian")
Species    = Enum("Authentic", "Plagal")
Motion     = Enum("Parallel", "Similar", "Contrary", "Oblique")

Cantus    = List[Pitch]         # immutable input
Counterpt = List[Pitch]         # mutable, one element per cantus note

State = {
    "cantus"        : Cantus,
    "cp"            : Counterpt,
    "mode"          : Mode,
    "species"       : Species,
    "position"      : "above" | "below"           # user choice for CP placement
}
 
1. Mode-Detection Routine (§ 1)
def detect_mode(cantus: Cantus) -> tuple[Mode, Species]:
    final = cantus[-1]                      # 1.1
    pitches = set(cantus)                   # 1.2-Method-step-1
    candidates = []                         # 1.2-Method-step-2

    for mode in six_modes:                  # pre-coded table from § 1.2
        if all( pitch in modal_scale(final, mode)
                or pitch == licensed_accidental(final, mode)
                for pitch in pitches ):
            candidates.append(mode)

    if len(candidates) == 0:
        raise ModalError("Cantus is non-modal")

    low, high = ambitus(cantus, final)      # 1.3
    species = "Plagal" if low <= -4 and high <= +5 else "Authentic"

    mode = resolve_by_cadence(cantus, final, species, candidates)  # 1.4
    audit_accidentals(cantus, mode)        # 1.5

    return mode, species                   # 1.6
 
2. Note-Generation Loop (§ 6)
def build_counterpoint(state: State) -> Counterpt:
    for idx, cf_note in enumerate(state["cantus"]):
        candidates = legal_consonant_pitches(cf_note, state)       # § 2

        # Depth-first search with backtracking
        placed = False
        for cp_note in candidates:
            if validate_all_rules(state, cf_note, cp_note, idx):
                state["cp"].append(cp_note)
                placed = True
                break

        if not placed:                # 6.3 backtracking
            back_up(state)            # erase previous CP note(s)
            return build_counterpoint(state)

    return state["cp"]
 
3. Rule-Validation Pipeline (§ 6.2)
def validate_all_rules(state, cf, cp, i) -> bool:
    return (   vertical_consonance(cp, cf, state)        # 6.2-1  &  § 2
            and motion_ok(cp, state, i)                  # 6.2-2  &  § 3
            and no_hidden_parallels(cp, state, i)        # 6.2-3  &  § 3.3
            and melodic_ok(cp, state, i)                 # 6.2-4  &  § 4
            and spacing_ok(cp, state, i)                 # 6.2-5  &  § 5
            and accidental_ok(cp, state, i))             # 6.2-6  &  § 1.5
3.1 Vertical Consonance (§ 2)
def vertical_consonance(cp, cf, state):
    interval = get_interval(cp, cf, state["position"])
    if interval not in perfect+imperfect: return False            # 2.1-2
    if cadence_penult(cf, state, interval) is False:   return False
    return consonance_balance_ok(state)                           # 2.1-3
3.2 Motion Rules (§ 3)
def motion_ok(cp, state, i):
    if i == 0: return True
    motion = classify_motion(state["cp"][i-1], cp,
                             state["cantus"][i-1], state["cantus"][i])
    prev_int = classify_interval(state["cp"][i-1], state["cantus"][i-1], state)
    curr_int = classify_interval(cp,               state["cantus"][i],   state)
    return motion_matrix[prev_int][curr_int](motion)   # implements table § 3.2
3.3 Forbidden Parallels & Hidden Perfects (§ 3.3)
def no_hidden_parallels(cp, state, i):
    if i == 0: return True
    return not forms_parallel_5th_or_8ve(state["cp"][i-1], cp,
                                         state["cantus"][i-1], state["cantus"][i])
3.4 Melodic Fitness (§ 4)
def melodic_ok(cp, state, i):
    line = state["cp"]
    return (   leap_size_ok(line, i)               # 4.1
            and leap_compensation_ok(line, i)      # 4.2
            and no_pitch_triplet(line, i)          # 4.3
            and no_melodic_tritone(line, i)        # 4.4
            and within_range(line[i]) )            # 4.5
3.5 Spacing / Voice-Crossing (§ 5)
def spacing_ok(cp, state, i):
    interval = abs(semitone_distance(cp, state["cantus"][i]))
    return ( interval <= 18                      # ≤ 11th (5.3)
         and not excessive_closeness(cp, state, i)
         and acceptable_crossing(cp, state, i) ) # 5.2
3.6 Modal & Accidental Compliance (§ 1.5)
def accidental_ok(cp, state, i):
    if is_accidental(cp):
        cf_last_idx = len(state["cantus"]) - 1
        if i == cf_last_idx - 1 and leading_tone_ok(cp, state): return True
        if removes_mi_fa_tritone(state["cp"], i):               return True
        return False
    return True
 
4. Helper Tables & Predicates
•	perfect = {"P1","P5","P8"}
•	imperfect = {"m3","M3","m6","M6"}
•	motion_matrix implements the four legal progressions (3.2).
•	modal_scale(final, mode) returns the diatonic pitch-set of that mode.
•	licensed_accidental(...) implements § 1.2 third column.
 
5. Interface End-Points
Function	Input	Output	Behaviour
analyse_mode(cantus)	Cantus	(Mode, Species)	Throws ModalError on failure. Implements section 1.
generate_counterpoint(cantus, position)	Cantus, "above"/"below"	Counterpt	Returns a fully-validated CP or raises NoSolutionError. Relies on rules 2–6.
validate_counterpoint(cantus, cp, position)	Cantus, Counterpt, "above"/"below"	True / list[RuleError]	Checks an existing CP against all constraints, reporting first violation encountered.
 
Usage Example (in an LLM-powered composition endpoint)
cantus = ["D4","E4","F4","G4","A4","G4","F4","E4","D4"]  # Dorian
mode, species = analyse_mode(cantus)

state = {
    "cantus"   : cantus,
    "cp"       : [],
    "mode"     : mode,
    "species"  : species,
    "position" : "above"             # user choice
}

counterpoint = generate_counterpoint(**state)
If generate_counterpoint exhausts every branch without success it throws NoSolutionError, signalling that with the current cantus no first-species line can satisfy every rule (rare but possible).
 
This specification is deterministic and exhaustive:
•	Every rule in sections 1–5 translates to a boolean predicate.
•	Section 6 becomes a depth-first search with backtracking driven by those predicates.
•	The API surfaces analyse, generate, and validate endpoints, allowing any LLM or external program to enforce or explore strict first-species counterpoint exactly as in Fux’s Gradus.
